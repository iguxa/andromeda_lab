Создайте в своём MySQL базу данных указанной структуры:

CREATE DATABASE `test_andromeda`;
USE `test_andromeda`;
GRANT ALL PRIVILEGES ON test_andromeda.* TO test_user@localhost IDENTIFIED BY '123123';
FLUSH PRIVILEGES;

CREATE TABLE `account` (
`id`         INT(11) NOT NULL,
`fio`       VARCHAR(255),
`sex`     INT(11) COMMENT '0 - не указан, 1 - мужчина, 2 - женщина.',
`birthdate` INT(11) COMMENT 'Дата в unixtime.',
`has_work` int(11) comment '1 - Есть работа, 0 – нет работы',
PRIMARY KEY (`id`)
);

CREATE TABLE `loan` (
`id`      INT(11) NOT NULL AUTO_INCREMENT,
`account_id` INT(11),
`amount` int(11),
PRIMARY KEY (`id`)
);

INSERT INTO `account` 
(`id`, `fio`, `sex`, `birthdate`, `has_work`)
VALUES 
(1, 'Иванов Иван Иванович', 1, 318286800, 1),
(2, 'Петров Петр Петрович', 1, 318286800, 0),
(3, 'Сидоров Сидор Сидорович', 1, 318286800, 1),
(4, 'Иванова Мария Ивановна', 2, 791672400, 0),
(5, 'Петрова Мария Петровна', 2, 318286800, 1),
(6, 'Сидорова Мария Сидоровна', 2, 602370000, 0);

INSERT INTO `loan`
(`account_id`, `amount`)
VALUES 
(1, 20000),
(1, 25000),
(2, 20000),
(4, 130000),
(4, 20000);

а) Представьте, что данных в этих таблицах очень много, сотни миллионов записей. Если вам кажется, что с таблицами или данными что-то не так - исправьте по своему усмотрению. Опишите в комментариях, что вы сделали и почему.
б) Напишите запрос, возвращающий имя, количество кредитов и общую сумму кредитов для работающих мужчин, имеющих не более 2-х кредитов на общую сумму не более 50000 т.р. Отсортируйте по возрастанию общей суммы кредитов.
в) Если вам кажется, что для быстрого выполнения этого запроса таблицы нуждаются в оптимизации - проделайте её по своему усмотрению. Опишите в комментариях, что вы сделали и почему.